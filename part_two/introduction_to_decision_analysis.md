## 決定分析の初歩
### 1.1 目標設定と手段選択

```
決定分析においては, 目標設定と手段選択の2つの段階に分けると見通しが良くなる
複数の選択肢の中から最も好ましいものを選ぶという手続きは, 2番目の手段選択にあたる

手段選択の前段階に当たる目標設定も, 欠かすことのできない重要なテーマである
選択肢の中で, 好ましさを評価するためには意思決定の目的を明確にする必要がある
```


### 1.2 意思決定問題の構成要素

```
決定分析が担う大きな役割は、意思決定問題の整理・表現である
決定分析においては、不確実性下の意思決定問題を下記の3つの構成要素に分けて整理する
  1. 選択肢
  2. 自然の状態
  3. 選択肢別、自然の状態別の結果

自然の状態がどのようなものになるかわからない中で「ある自然の状態だったときに, ある行動をとった時の結果」を参考にして意思決定を行う
```

### 1.3 今回扱う事例

```
ある工場である製品を作っている
工場には製品を作るための機械が2台あり, 稼働台数は1ヶ月おきに見直す
機械を多く動かすと沢山の製品が作れるが, その分稼働費用が増加する
製品の需要量は月ごとに変動する
```

### 1.4 意思決定問題の構造化

```
先の状況を, 決定分析の言葉を使って整理する
選択肢と自然の状態は下記のようになる
  選択肢: 機械の稼働台数（0台・1台・2台）
  自然の状態: 製品の需要量（好況・不況）

まずは決定分析の基本を学ぶために, あえて単純な事例を扱うものとする
```

```
選択肢の集合を行動空間, 自然の状態の集合を状態空間と呼ぶこともある
選択肢や状態の要素の個数が増えても, 分析の手続きはそれほど変わらない
ただし, 連続的に変化する無限の選択肢を想定すると, 数学的な取り扱いがやや難しくなる
本書では, 選択肢の集合も, 自然の状態の集合も共に有限集合とする
```

### 1.5 意思決定問題の一般的な表現
#### 1.5.1 選択肢

```
個別の選択肢をa_j、選択肢の集合をAと表記する. aj∈Aである, aj∈Aで「要素a_jは集合Aに属する」と読む
Aは有限集合とする, 集合Aの要素の個数, すなわち選択肢の数を#Aとする
ちなみに, aはactionの頭文字である

今回の事例では, a_1が「0台稼働」, a_2が「1台稼働」, a_3が「2台稼働」となる. #A=3である
```

#### 1.5.2 自然の状態

```
個別の自然の状態をθ_iと表記する. 自然の状態の集合をΘと表記する. Θは有限集合とする
状態の要素数の個数を#Θとする.

今回の事例ではθ_1が「好況」, θ_2が「不況」となる. #Θ=2である
```

#### 1.5.3 結果（利得行列）

```
選択肢a_jを状態θ_iのとき選んだ場合の利得をc(a_j, θ_i)と表記する
なお, cはconsequenceの頭文字である
利得を金額のような数値とする場合は, 選択肢Aと自然の状態Θの組み合わせを実数へ移す写像（関数）として
c: AxΘ→Rと表記できる
ただしxは直積の記号で, Rは実数全体の集合である

本書では便利な表記方法である利得行列を使用する. 利得表とも呼ぶ
利得行列は選択肢ごと, 自然の状態ごとに得られる利得をまとめた表である
```

<img width="538" alt="スクリーンショット 2021-07-17 9 56 22" src="https://user-images.githubusercontent.com/43327056/126020624-0051f2eb-b499-4228-94bb-56743d74227a.png">

```
今回の事例では, 自然の状態が2つ, 選択肢が3つあったので, 2行3列の利得行列であった
一般には#Θ行 #A列の行列となる. #Aが選択肢の, Θが自然の状態の要素の個数である
```

#### 1.5.4 意思決定問題の構成

```
意思決定問題を構成する要素をまとめたDを意思決定問題と呼ぶ
ここでは利得cが大きい方が好ましいと想定している
```

<img width="492" alt="スクリーンショット 2021-07-17 9 57 46" src="https://user-images.githubusercontent.com/43327056/126020657-c765b28d-a98c-499b-8c2a-323d74bac4b5.png">

### 1.6 結果の査定

```
今回は, 作った製品の売上からコストを差し引いた収入を最大化することを目的として意思決定を行うことにする
次のような利得行列が得られたと想定する。
```

<img width="536" alt="スクリーンショット 2021-07-17 10 00 17" src="https://user-images.githubusercontent.com/43327056/126020723-9cb79a64-16a4-428b-8efc-ca1676441468.png">

```
利得行列の行列名が自然の状態であり, 列名が選択肢である
全く稼働させない場合も維持費がかかるので、利益はマイナスになる
1台を稼働させたときは安定して収入が得られる
2台稼働させた時は, 好況の時は多くの収入が得られるが, 不況の時は機械の稼働コストがかさみ赤字になる
```

### 1.7 優越する決定

```
自然の状態によらず, 常にある選択肢が別の選択肢よりも好ましい結果を持つとき, その選択肢を選ぶことを優越する決定と呼ぶ
今回の例では, 「1台稼働」を選択することは, 「0台稼働」を優越する
```

### 1.8 決定基準

```
以下では, 伝特的にしばしば用いられ, 意味づけが明確である決定基準を5つ紹介する
どの決定基準を採用すべきか, ということは誰にもわからない
```

### 1.9 マキシマックス（Maximax）基準

```
マキシマックス（Maximax）基準は, 最大利得が発生する自然の状態を仮定した上でそのときの利得を最大にするように選択肢を選ぶ
マキシマックス基準を適用する際, まずは下記のように選択肢ごとの最大利得でλ_{max}(a_j)を計算する
次の式では「θ_iを色々と変化させてc(a_j, θ_i)の最大値をとる」ということをしている
```

<img width="486" alt="スクリーンショット 2021-07-17 10 05 22" src="https://user-images.githubusercontent.com/43327056/126020848-671a8285-720d-4276-937d-5bf9adfbda92.png">

```
そして以下のようにλ_{max}(a_j)を最大にする選択肢a^maxを採択する
{argmax ○○}\n{a_j}という記号は「○○を最大にするa_jという意味である」
```

<img width="486" alt="スクリーンショット 2021-07-17 10 05 44" src="https://user-images.githubusercontent.com/43327056/126020862-c1c95bf7-82b3-4366-b8e8-c23ae64752e8.png">

```
マキシマックス基準は, 最も楽観的な決定基準であると言われる
自然の状態に不確実性があるが, その中で最も好都合な状態（最大利得が発生する状態）になると仮定する
その上で, 最も利得が高くなる選択肢を選ぶのがマキシマックス基準である
```

### 1.10 マキシミン（Maximin）基準

```
マキシミン（Maximin）基準は最小利得が発生する自然の状態を仮定した上で, そのときの利得を最大にするように選択肢を選ぶ
まずは下記のように選択肢ごとの最小利得λ_{min}(a_j)を計算する
```

<img width="486" alt="スクリーンショット 2021-07-17 10 12 03" src="https://user-images.githubusercontent.com/43327056/126021021-cc6b8b26-211a-47ea-a304-0eebd649046a.png">

```
そして以下のようにλ_{min}(a_j)を最大にする選択肢a^minを採択する
```

<img width="486" alt="スクリーンショット 2021-07-17 10 12 20" src="https://user-images.githubusercontent.com/43327056/126021022-7e4f2f1d-35e9-4ee4-807d-668cda22dfc2.png">

```
マキシミン基準は,最も悲観的な決定基準だと言われる
自然の状態に不確実性があるが, その中で最悪の状態（最小利得が発生する状態）になると仮定する
最悪な自然の状態を仮定した上で, 最も利得が高くなる選択肢を選ぶのがマキシミン基準である
```

### 1.11 ハーヴィッツ（Hurwicz）の基準

```
ハーヴィッツ（Hurwicz）の基準はマキシマックス基準とマキシミン基準を混合させたものだといえる
ハーヴィッツの基準では, まず選択肢ごとに最大利得と最小利得を計算する
そしてこれをパラメータαで重み付けしたλ_{Hurwicz}(a_j)を計算する
パラメータαは楽観係数と呼ぶ
```

<img width="486" alt="スクリーンショット 2021-07-17 11 48 26" src="https://user-images.githubusercontent.com/43327056/126023047-b824d1b2-38dc-4952-ab5f-457e764d7daf.png">

```
そして以下のようにλ_{Hurwicz}(a_j)を最大にする選択肢a^{Hurwicz}を採択する
```

<img width="486" alt="スクリーンショット 2021-07-17 11 50 40" src="https://user-images.githubusercontent.com/43327056/126023114-d50fe16e-540e-4ccf-a5df-2e49ad148aa5.png">

```
楽観係数αは意思決定者の主観で決められるため, ハーヴィッツの基準は極めて主観的な意思決定基準だと言える
```

### 1.12 ミニマックスリグレット（Minimax regret）基準

```
「後悔の大きさの最大値」を最小にする基準が, ミニマックスリグレット基準である

表2.1.2の利得行列を対象とすると, 好況のときには「2台稼働」を選べば700万円を得られる
仮に, 公共のときに「1台稼働」を選んだならば「本来は700万円もらえたはずが300万円しかもらえなかった = 400万円損した」となる
この400万円がリグレットである

リグレットは赤字の額ではなく, 「自然の状態ごとに見た最大利得と比較した差額（機会損失）」であることに注意する
そして, 最大リグレットを最小にする選択肢を採択する
```

```
リグレットの計算を数式で表現する
選択肢a_Jを状態θ_iのとき選んだ場合のリグレットをr(a_j, θ_i)と表記する
これは, 自然の状態ごとに見た最大利得から, 実際の利得を引いたものになる
```

<img width="486" alt="スクリーンショット 2021-07-17 12 02 00" src="https://user-images.githubusercontent.com/43327056/126023384-706d4493-288a-4a8d-8555-e5f365c2320e.png">

```
上記の式においてmaxの添字がa_jになっていることに注意する
状態ごとに見て, 選択肢a_jを変化させたときの利得の最大値である
```


### 1.13 ラプラス（Laplace）の基準

```
ラプラス（Laplace）の基準は, 選択肢ごとに利得の算術平均を計算して, その最大値をとる選択肢を採択する
まずは下記のように選択肢ごとの平均利得λ_{Laplace}(a_j)を計算する
```

<img width="486" alt="スクリーンショット 2021-07-17 12 18 43" src="https://user-images.githubusercontent.com/43327056/126023841-16ec660a-3d56-45f2-9c0e-845c8828a1f3.png">

```
そして以下のようにλ_{Laplace}(a_j)を最大にする選択肢a^{Laplace}を採択する
```

<img width="486" alt="スクリーンショット 2021-07-17 12 19 03" src="https://user-images.githubusercontent.com/43327056/126023842-0c6e3c78-81e0-4b16-b005-11f49e6cbc6c.png">

```
ラプラスの基準は, 自然の状態がすべて等しい確率で出現すると考える
そして利得の利得の期待値を最大にするように選択肢を選ぶ
```
